# Проект по распознаванию показаний счетчиков

Этот проект предназначен для автоматизации процесса распознавания показаний счетчиков с изображений. Система использует комбинацию моделей: YOLO для обнаружения цифр и кастомных сверточных нейронных сетей (CNN) для распознавания перевернутых изображений и цифр. В результате проект позволяет точно определять значения, отображаемые на счетчиках, по загруженным изображениям.

---

## **Структура проекта**


### **1. `requirements.txt`**
Файл со списком необходимых библиотек и их версий для работы проекта. Установка всех зависимостей:
```bash
pip install -r requirements.txt
```

---

### **2. `YoloTrain.py`**
Скрипт для обучения модели YOLO:
- Подготавливает данные для обучения, включая преобразование меток.
- Обучает модель YOLO с использованием файла `dataset.yaml`.
- Поддерживает обучение как для классических ограничивающих рамок (BBox), так и для ориентированных (OBB).

---

### **3. `dataset.yaml`**
Файл конфигурации для обучения модели YOLO. В нем указаны пути к данным, классы объектов и параметры обучения. 

---

### **4. `YoloCrop.py`**
Модуль для обработки изображений:
- Выделяет области с цифрами с помощью модели YOLO.
- Сохраняет вырезанные изображения цифр в папку для дальнейшей обработки CNN.

---

### **5. `Train_CNN_for_digit_recognition.py`**
Скрипт для обучения кастомной CNN модели для распознавания цифр:
- Использует изображения цифр в качестве входных данных.
- Результат обучения — файл с весами модели (`CustomCNNForDigits.pth`), который используется в основном скрипте.

---

### **6. `Train_CNN_for_upside_down_images.py`**
Скрипт для обучения кастомной CNN модели для распознавания перевернутых изображений:
- Использует изображения с метками, указывающими, перевернуто ли изображение.
- Результат обучения — файл с весами модели (`CustomCNNForUpsideDownImages.pth`), который используется в основном скрипте для обработки перевернутых изображений.

---

### **7. `Meter-reading-recognition.py`**
Основной скрипт для выполнения распознавания показаний счетчиков. 
- Использует предварительно обученные модели YOLO и CNN.
- Реализует обработку одиночных изображений и целых папок.
- Выводит результаты распознанных значений в консоль. 

---

### **8. `meter-recognizer.py`**
Скрипт для распознавания показаний счетчиков с изображения:
- Использует модели YOLO и кастомные CNN для распознавания объектов, перевернутых изображений и цифр.
- Принимает путь к изображению в качестве аргумента.
- Выводит распознанное значение счетчика.


---
## Установка и запуск

Для запуска проекта выполните следующие шаги.

### Запуск через Docker

1. **Соберите Docker-образ**

   Выполните команду из корневой папки проекта:

   ```bash
   docker build -t meter-recognizer .
   ```

2. **Запустите контейнер**

   - **Для распознавания показания одного счетчика**:

     Убедитесь, что файл с изображением доступен в контейнере.


    - На MacOS и Linux:
     ```bash
     docker run --rm -v $(pwd)/data:/data meter-recognizer --image-path data/ImagesForRecognition/id_8_value_1095_124.jpg
     ```

    - На Windows:
    ```bash
     docker run-v  "Путь к папке с изображением:/data" meter-recognizer --image-path data/ImagesForRecognition/id_8_value_1095_124.jpg
     ```
     
     Это подключит папку `data` из текущей директории на локальном компьютере в контейнер, и скрипт сможет считать файл для распознавания.


## **Вывод**
Проект представляет собой мощное решение для автоматического распознавания показаний счетчиков с использованием современных методов. Интеграция моделей YOLO и CNN позволяет эффективно обрабатывать изображения и точно распознавать значения.